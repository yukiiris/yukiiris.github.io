---
layout: post
title: "bilibili连播chrome插件"
date: 2017-09-07
excerpt: ""
tags: [JavaScript]
comments: true
---

## 前言

&nbsp; &nbsp;  &nbsp; bilibili没有视频连播功能，每次看比较短的视频，比如听某个唱见的歌，每次三五分钟就结束，又要切回去点下一个播放，非常麻烦，所以想写一个连播插件造福自己。看了下chrome的文档，写插件不是很难，正好也巩固下我的JavaScript。

## 简介

 &nbsp;  &nbsp; 功能大概是这样子的：右键将bilibili视频链接加入待看列表，打开插件页点击开始，视频即开始播放。支持链接删除、置顶，播放暂停等功能。（待实现）

## 难点

* 数据的储存
  + popup.html页面弹出再消失是算作一次js完整周期的，所以不能将链接列表存在变量里。后来发现h5新加了web储存——localstorage，支持永久储存浏览器数据，非常适合解决这个问题。一个缺点是localstorage只支持字符串，只能把链接以字符串的形式储存了。
* 确定视频是否播放完
  + js离开本网页后就不再起作用，如何判断视频播放状态是一个问题。
* js的使用限制
  + 出于安全考虑，chrome插件代码中限制js的使用，给添加功能造成了一些的不便，最后将js都写在了文件里，html引用js文件。